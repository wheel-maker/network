# 服务器端的局域网

### 1. Web服务器的部署

- **部署在内网使用防火墙机制**：与POP连接，屏蔽不允许从外部访问的应用程序
- **部署在数据中心**：与NOC或IX相连接，利用运营商管理的数据中心获得高访问量

### 2. 防火墙的结构与原理（包过滤方式）

- **通过设置端口号限定应用程序**
- **通过控制位判断连接方向**
- **设置地址转化功能**

> 防火墙无法阻止只有通过检查包的内容才能识别的风险

### 3. 通过将请求平均分配给多台服务器来平衡负载

1. **通过DNS服务器轮询的方式**

2. **通过负载均衡器分配访问**

   - **代替Web服务器注册到DNS服务器上**
   - **定期采集Web服务器的数据或由事先设置的服务器性能参数按比例分配请求**

   - 跨页面请求信息：通过对**HTTP规格扩展，在头部加入判断相关性的信息**

### 4. 使用缓存服务器分担负载

1. 缓存服务器是一台通过**代理机制**对数据进行缓存的服务器

2. **反向代理**

   - 代替Web服务器注册到DNS服务器
   - 如果数据不存在，在HTTP头部添加**Via字段**，通过**请求消息的URI**判断转发Web服务器
   - 如果数据存在，添加**If-Modified-Since头部字段**，Web服务器返回响应消息

3. **正向代理**

   - 放置在**客户端一侧**，具有**缓存功能**，需要**在浏览器中设置代理服务器的IP地址**

   - 通过**查看包的内容**实现**防火墙**的功能

4. **透明代理**

   - 通过**查看请求消息的包头部**，确定转发目标

   - 可以**在接入网的入口处**放置**透明代理**

### 5. 内容分发服务

1. **CDSP**：提供内容分发服务的厂商

   > CDSP专门部署缓存服务器，并租借给Web服务器运营者

2. **寻找最近缓存服务器**

   1. **在所有缓存服务器端设置路由器**的方法
      - 在**Web服务器端的DNS服务器**中存储所有**缓存服务器端路由器的路由器表信息**
      - 根据路由表信息计算**到客户端DNS服务器的距离**，从而查询出**最近的缓存服务器**

   2. **重定向**的方法
      - 将**重定向服务器**注册到**Web服务器端的DNS服务器**上
      - 收集路由信息，利用**HTTP消息中Location字段**，发送最近的缓存服务器地址

3. **缓存内容的更新方法**

   Web服务器在原始数据更新时，立即通知缓存服务器